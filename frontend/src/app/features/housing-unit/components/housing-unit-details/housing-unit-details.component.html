<div class="details-container" *ngIf="unit">
  <!-- Header -->
  <div class="details-header">
    <div>
      <a [routerLink]="['/buildings', unit.buildingId]" class="breadcrumb">{{
        unit.buildingName
      }}</a>
      <span class="separator">›</span>
      <h2>Unit {{ unit.unitNumber }}</h2>
    </div>
    <div class="header-actions">
      <button class="btn btn-secondary" (click)="edit()">Edit</button>
      <button class="btn btn-danger" (click)="confirmDelete()">Delete</button>
    </div>
  </div>

  <!-- Info section -->
  <section>
    <h3>Information</h3>
    <div class="info-grid">
      <div>
        <label>Unit Number</label>
        <span>{{ unit.unitNumber }}</span>
      </div>
      <div>
        <label>Floor</label>
        <span>{{ unit.floor }}</span>
      </div>
      <div *ngIf="unit.landingNumber">
        <label>Landing</label>
        <span>{{ unit.landingNumber }}</span>
      </div>
      <div *ngIf="unit.totalSurface">
        <label>Total Surface</label>
        <span>{{ unit.totalSurface }} m²</span>
      </div>
      <div>
        <label>Owner</label>
        <span>{{ unit.ownerName ?? "—" }}</span>
      </div>
      <div *ngIf="unit.hasTerrace">
        <label>Terrace</label>
        <span>
          {{ unit.terraceSurface ? unit.terraceSurface + " m²" : "—" }}
          {{ unit.terraceOrientation ? " · " + unit.terraceOrientation : "" }}
        </span>
      </div>
      <div *ngIf="unit.hasGarden">
        <label>Garden</label>
        <span>
          {{ unit.gardenSurface ? unit.gardenSurface + " m²" : "—" }}
          {{ unit.gardenOrientation ? " · " + unit.gardenOrientation : "" }}
        </span>
      </div>
    </div>
  </section>

  <!-- Rooms section — UC003 -->
  <section>
    <app-room-section [unitId]="unit.id"></app-room-section>
  </section>

  <!-- PEB section — UC004 -->
  <section>
    <app-peb-section [unitId]="unit.id"></app-peb-section>
  </section>

  <!-- Rent section — UC005 -->
  <section>
    <app-rent-section [unitId]="unit.id"></app-rent-section>
  </section>

  <!-- Meters section — UC008 -->
  <section>
    <app-meter-section [ownerType]="'HOUSING_UNIT'" [ownerId]="unit.id">
    </app-meter-section>
  </section>

  <!-- Lease section — UC010 -->
  <section>
    <app-lease-section [unitId]="unit.id"></app-lease-section>
  </section>

  <!-- Delete confirmation -->
  <div *ngIf="showDeleteConfirm" class="modal-overlay">
    <div class="modal-content">
      <h3>Delete Unit</h3>
      <p>
        Are you sure you want to delete unit
        <strong>{{ unit.unitNumber }}</strong
        >?
      </p>
      <p class="warning">This action cannot be undone.</p>
      <div *ngIf="deleteError" class="error-msg">{{ deleteError }}</div>
      <div class="modal-actions">
        <button class="btn btn-secondary" (click)="showDeleteConfirm = false">
          Cancel
        </button>
        <button class="btn btn-danger" (click)="delete()" [disabled]="deleting">
          {{ deleting ? "Deleting…" : "Delete" }}
        </button>
      </div>
    </div>
  </div>
</div>

<div *ngIf="loading" class="loading-state">Loading…</div>
