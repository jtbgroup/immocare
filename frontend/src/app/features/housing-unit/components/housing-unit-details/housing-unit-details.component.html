<div class="unit-details-container" *ngIf="unit">
  <!-- Breadcrumb -->
  <nav class="breadcrumb" aria-label="breadcrumb">
    <a [routerLink]="['/buildings', unit.buildingId]">{{
      unit.buildingName
    }}</a>
    <span class="breadcrumb-separator">›</span>
    <span>Unit {{ unit.unitNumber }}</span>
  </nav>

  <!-- Header -->
  <div class="details-content">
    <div class="header">
      <h1>Unit {{ unit.unitNumber }}</h1>
      <div class="actions">
        <button class="btn btn-secondary" (click)="edit()">Edit</button>
        <button class="btn btn-danger" (click)="confirmDelete()">Delete</button>
      </div>
    </div>
  </div>

  <!-- Information -->
  <div class="info-card">
    <h2>Information</h2>
    <div class="info-grid">
      <div class="info-item">
        <label>Unit Number</label>
        <p>{{ unit.unitNumber }}</p>
      </div>
      <div class="info-item">
        <label>Floor</label>
        <p>{{ unit.floor }}</p>
      </div>
      <div class="info-item" *ngIf="unit.landingNumber">
        <label>Landing</label>
        <p>{{ unit.landingNumber }}</p>
      </div>
      <div class="info-item" *ngIf="unit.totalSurface">
        <label>Total Surface</label>
        <p>{{ unit.totalSurface }} m²</p>
      </div>
      <div class="info-item">
        <label>Owner</label>
        <p>
          <a
            *ngIf="unit.ownerId; else ownerText"
            [routerLink]="['/persons', unit.ownerId]"
          >
            {{ unit.ownerName }}
          </a>
          <ng-template #ownerText>{{ unit.ownerName ?? "—" }}</ng-template>
        </p>
      </div>
      <div class="info-item" *ngIf="unit.hasTerrace">
        <label>Terrace</label>
        <p>
          {{ unit.terraceSurface ? unit.terraceSurface + " m²" : "—" }}
          {{ unit.terraceOrientation ? " · " + unit.terraceOrientation : "" }}
        </p>
      </div>
      <div class="info-item" *ngIf="unit.hasGarden">
        <label>Garden</label>
        <p>
          {{ unit.gardenSurface ? unit.gardenSurface + " m²" : "—" }}
          {{ unit.gardenOrientation ? " · " + unit.gardenOrientation : "" }}
        </p>
      </div>
    </div>
  </div>

  <!-- Rooms — UC003 -->
  <div class="info-card">
    <app-room-section [unitId]="unit.id"></app-room-section>
  </div>

  <!-- PEB — UC004 -->
  <div class="info-card">
    <app-peb-section [unitId]="unit.id"></app-peb-section>
  </div>

  <!-- Rent — UC005 -->
  <div class="info-card">
    <app-rent-section [unitId]="unit.id"></app-rent-section>
  </div>

  <!-- Meters — UC008 -->
  <div class="info-card">
    <app-meter-section
      [ownerType]="'HOUSING_UNIT'"
      [ownerId]="unit.id"
    ></app-meter-section>
  </div>

  <!-- Meters — UC011 -->
  <div class="info-card">
    <app-boiler-section ownerType="HOUSING_UNIT" [ownerId]="unit.id" />
  </div>

  <!-- Lease — UC010 -->
  <div class="info-card">
    <app-lease-section [unitId]="unit.id"></app-lease-section>
  </div>
</div>

<!-- Loading -->
<div *ngIf="loading" class="loading">Loading...</div>

<!-- Delete Confirmation Modal -->
<div *ngIf="showDeleteConfirm" class="modal-overlay">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Delete Unit</h2>
    </div>
    <div class="modal-body">
      <p>
        Are you sure you want to delete unit
        <strong>{{ unit?.unitNumber }}</strong
        >?
      </p>
      <p class="warning">This action cannot be undone.</p>
      <div *ngIf="deleteError" class="alert alert-error">{{ deleteError }}</div>
    </div>
    <div class="modal-actions">
      <button class="btn btn-secondary" (click)="showDeleteConfirm = false">
        Cancel
      </button>
      <button class="btn btn-danger" (click)="delete()" [disabled]="deleting">
        {{ deleting ? "Deleting..." : "Delete" }}
      </button>
    </div>
  </div>
</div>
