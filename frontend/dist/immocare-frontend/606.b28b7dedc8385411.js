"use strict";(self.webpackChunkimmocare_frontend=self.webpackChunkimmocare_frontend||[]).push([[606],{606:(R,c,r)=>{r.r(c),r.d(c,{BuildingDetailsComponent:()=>x});var d=r(177),g=r(1413),l=r(6977),m=r(9674),p=r(6238),n=r(4438),b=r(2304),a=r(7282);function f(e,s){1&e&&(n.j41(0,"div",6),n.EFF(1,"Loading units\u2026"),n.k0s())}function _(e,s){1&e&&(n.j41(0,"div",7)(1,"p"),n.EFF(2,'No units yet. Click "Add Housing Unit" to get started.'),n.k0s()())}function h(e,s){if(1&e&&(n.j41(0,"span",13),n.EFF(1),n.k0s()),2&e){const t=n.XpG().$implicit,o=n.XpG(2);n.xc7("background",o.pebDisplay[t.currentPebScore].color)("color",o.pebDisplay[t.currentPebScore].textColor),n.R7$(),n.SpI(" ",o.pebDisplay[t.currentPebScore].label," ")}}function C(e,s){1&e&&(n.j41(0,"span"),n.EFF(1,"\u2014"),n.k0s())}function F(e,s){if(1&e){const t=n.RV6();n.j41(0,"tr",10),n.bIt("click",function(){const i=n.eBV(t).$implicit,u=n.XpG(2);return n.Njj(u.viewUnit(i.id))}),n.j41(1,"td"),n.EFF(2),n.k0s(),n.j41(3,"td"),n.EFF(4),n.k0s(),n.j41(5,"td"),n.EFF(6),n.k0s(),n.j41(7,"td"),n.EFF(8),n.k0s(),n.j41(9,"td"),n.EFF(10),n.k0s(),n.j41(11,"td"),n.DNE(12,h,2,5,"span",11)(13,C,2,0,"span",12),n.k0s(),n.j41(14,"td"),n.EFF(15),n.k0s()()}if(2&e){let t,o;const i=s.$implicit;n.R7$(2),n.JRh(i.unitNumber),n.R7$(2),n.JRh(i.floor),n.R7$(2),n.JRh(null!==(t=i.totalSurface)&&void 0!==t?t:"\u2014"),n.R7$(2),n.JRh(i.roomCount),n.R7$(2),n.SpI(" ",i.currentMonthlyRent?"\u20ac"+i.currentMonthlyRent+"/mo":"\u2014"," "),n.R7$(2),n.Y8G("ngIf",i.currentPebScore),n.R7$(),n.Y8G("ngIf",!i.currentPebScore),n.R7$(2),n.JRh(null!==(o=i.ownerName)&&void 0!==o?o:"\u2014")}}function k(e,s){if(1&e&&(n.j41(0,"table",8)(1,"thead")(2,"tr")(3,"th"),n.EFF(4,"Unit #"),n.k0s(),n.j41(5,"th"),n.EFF(6,"Floor"),n.k0s(),n.j41(7,"th"),n.EFF(8,"Surface (m\xb2)"),n.k0s(),n.j41(9,"th"),n.EFF(10,"Rooms"),n.k0s(),n.j41(11,"th"),n.EFF(12,"Rent"),n.k0s(),n.j41(13,"th"),n.EFF(14,"PEB"),n.k0s(),n.j41(15,"th"),n.EFF(16,"Owner"),n.k0s()()(),n.j41(17,"tbody"),n.DNE(18,F,16,8,"tr",9),n.k0s()()),2&e){const t=n.XpG();n.R7$(18),n.Y8G("ngForOf",t.units)}}let v=(()=>{class e{constructor(t,o){this.housingUnitService=t,this.router=o,this.units=[],this.loading=!1,this.destroy$=new g.B,this.pebDisplay=p.o}ngOnInit(){this.loadUnits()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadUnits(){this.buildingId&&(this.loading=!0,this.housingUnitService.getUnitsByBuilding(this.buildingId).pipe((0,l.Q)(this.destroy$)).subscribe({next:t=>{this.units=t,this.loading=!1},error:()=>{this.loading=!1}}))}viewUnit(t){this.router.navigate(["/units",t])}addUnit(){this.router.navigate(["/units/new"],{queryParams:{buildingId:this.buildingId}})}static{this.\u0275fac=function(o){return new(o||e)(n.rXU(b.J),n.rXU(a.Ix))}}static{this.\u0275cmp=n.VBU({type:e,selectors:[["app-housing-unit-list"]],inputs:{buildingId:"buildingId"},standalone:!0,features:[n.aNF],decls:9,vars:3,consts:[[1,"unit-list-container"],[1,"unit-list-header"],[1,"btn","btn-primary",3,"click"],["class","loading",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","unit-table",4,"ngIf"],[1,"loading"],[1,"empty-state"],[1,"unit-table"],["class","unit-row",3,"click",4,"ngFor","ngForOf"],[1,"unit-row",3,"click"],["class","peb-badge",3,"background","color",4,"ngIf"],[4,"ngIf"],[1,"peb-badge"]],template:function(o,i){1&o&&(n.j41(0,"div",0)(1,"div",1)(2,"h3"),n.EFF(3,"Housing Units"),n.k0s(),n.j41(4,"button",2),n.bIt("click",function(){return i.addUnit()}),n.EFF(5," Add Housing Unit "),n.k0s()(),n.DNE(6,f,2,0,"div",3)(7,_,3,0,"div",4)(8,k,19,1,"table",5),n.k0s()),2&o&&(n.R7$(6),n.Y8G("ngIf",i.loading),n.R7$(),n.Y8G("ngIf",!i.loading&&0===i.units.length),n.R7$(),n.Y8G("ngIf",!i.loading&&i.units.length>0))},dependencies:[d.MD,d.Sq,d.bT],styles:[".unit-list-container[_ngcontent-%COMP%]{margin-top:1.5rem}.unit-list-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.unit-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.unit-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .unit-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.6rem 1rem;border-bottom:1px solid #e0e0e0;text-align:left}.unit-row[_ngcontent-%COMP%]{cursor:pointer}.unit-row[_ngcontent-%COMP%]:hover{background:#f5f5f5}.empty-state[_ngcontent-%COMP%]{color:#888;padding:1rem 0}.loading[_ngcontent-%COMP%]{padding:1rem 0}.btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:4px;cursor:pointer}.btn-primary[_ngcontent-%COMP%]{background:#007bff;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:#0056b3}.peb-badge[_ngcontent-%COMP%]{display:inline-block;padding:2px 8px;border-radius:4px;font-weight:700;font-size:.85rem;min-width:32px;text-align:center}"]})}}return e})();var P=r(7952);function O(e,s){1&e&&(n.j41(0,"div",4),n.EFF(1,"Loading building details..."),n.k0s())}function M(e,s){if(1&e){const t=n.RV6();n.j41(0,"div",5)(1,"p",6),n.EFF(2),n.k0s(),n.j41(3,"button",7),n.bIt("click",function(){n.eBV(t);const i=n.XpG();return n.Njj(i.goBack())}),n.EFF(4," Back to Buildings "),n.k0s()()}if(2&e){const t=n.XpG();n.R7$(2),n.JRh(t.error)}}function j(e,s){if(1&e&&(n.j41(0,"div",20),n.EFF(1),n.k0s()),2&e){const t=n.XpG(2);n.R7$(),n.SpI(" ",t.deleteError," ")}}function y(e,s){if(1&e){const t=n.RV6();n.j41(0,"div",21)(1,"div",22)(2,"h3"),n.EFF(3,"Delete Building"),n.k0s(),n.j41(4,"p"),n.EFF(5," Are you sure you want to delete "),n.j41(6,"strong"),n.EFF(7),n.k0s(),n.EFF(8,"? "),n.k0s(),n.j41(9,"p",23),n.EFF(10,"This action cannot be undone."),n.k0s(),n.j41(11,"div",24)(12,"button",11),n.bIt("click",function(){n.eBV(t);const i=n.XpG(2);return n.Njj(i.cancelDelete())}),n.EFF(13," Cancel "),n.k0s(),n.j41(14,"button",12),n.bIt("click",function(){n.eBV(t);const i=n.XpG(2);return n.Njj(i.deleteBuilding())}),n.EFF(15," Delete "),n.k0s()()()()}if(2&e){const t=n.XpG(2);n.R7$(7),n.JRh(t.building.name)}}function E(e,s){if(1&e){const t=n.RV6();n.j41(0,"div",8)(1,"div",9)(2,"h1"),n.EFF(3),n.k0s(),n.j41(4,"div",10)(5,"button",11),n.bIt("click",function(){n.eBV(t);const i=n.XpG();return n.Njj(i.goBack())}),n.EFF(6,"Back"),n.k0s(),n.j41(7,"button",7),n.bIt("click",function(){n.eBV(t);const i=n.XpG();return n.Njj(i.editBuilding())}),n.EFF(8,"Edit"),n.k0s(),n.j41(9,"button",12),n.bIt("click",function(){n.eBV(t);const i=n.XpG();return n.Njj(i.confirmDelete())}),n.EFF(10,"Delete"),n.k0s()()(),n.DNE(11,j,2,1,"div",13),n.j41(12,"div",14)(13,"h2"),n.EFF(14,"Building Information"),n.k0s(),n.j41(15,"div",15)(16,"div",16)(17,"label"),n.EFF(18,"Building Name"),n.k0s(),n.j41(19,"p"),n.EFF(20),n.k0s()(),n.j41(21,"div",16)(22,"label"),n.EFF(23,"Street Address"),n.k0s(),n.j41(24,"p"),n.EFF(25),n.k0s()(),n.j41(26,"div",16)(27,"label"),n.EFF(28,"Postal Code"),n.k0s(),n.j41(29,"p"),n.EFF(30),n.k0s()(),n.j41(31,"div",16)(32,"label"),n.EFF(33,"City"),n.k0s(),n.j41(34,"p"),n.EFF(35),n.k0s()(),n.j41(36,"div",16)(37,"label"),n.EFF(38,"Country"),n.k0s(),n.j41(39,"p"),n.EFF(40),n.k0s()(),n.j41(41,"div",16)(42,"label"),n.EFF(43,"Owner"),n.k0s(),n.j41(44,"p"),n.EFF(45),n.k0s()(),n.j41(46,"div",16)(47,"label"),n.EFF(48,"Housing Units"),n.k0s(),n.j41(49,"p"),n.EFF(50),n.k0s()()()(),n.j41(51,"div",14)(52,"h2"),n.EFF(53,"Audit Information"),n.k0s(),n.j41(54,"div",15)(55,"div",16)(56,"label"),n.EFF(57,"Created By"),n.k0s(),n.j41(58,"p"),n.EFF(59),n.k0s()(),n.j41(60,"div",16)(61,"label"),n.EFF(62,"Created At"),n.k0s(),n.j41(63,"p"),n.EFF(64),n.k0s()(),n.j41(65,"div",16)(66,"label"),n.EFF(67,"Last Updated"),n.k0s(),n.j41(68,"p"),n.EFF(69),n.k0s()()()(),n.j41(70,"div",14),n.nrm(71,"app-meter-section",17),n.k0s(),n.j41(72,"div",14),n.nrm(73,"app-housing-unit-list",18),n.k0s(),n.DNE(74,y,16,1,"div",19),n.k0s()}if(2&e){const t=n.XpG();n.R7$(3),n.JRh(t.building.name),n.R7$(8),n.Y8G("ngIf",t.deleteError),n.R7$(9),n.JRh(t.building.name),n.R7$(5),n.JRh(t.building.streetAddress),n.R7$(5),n.JRh(t.building.postalCode),n.R7$(5),n.JRh(t.building.city),n.R7$(5),n.JRh(t.building.country),n.R7$(5),n.JRh(t.building.ownerName||"Not specified"),n.R7$(5),n.SpI("",t.building.unitCount," units"),n.R7$(9),n.JRh(t.building.createdByUsername||"N/A"),n.R7$(5),n.JRh(t.formatDate(t.building.createdAt)),n.R7$(5),n.JRh(t.formatDate(t.building.updatedAt)),n.R7$(2),n.Y8G("ownerType","BUILDING")("ownerId",t.building.id),n.R7$(2),n.Y8G("buildingId",t.building.id),n.R7$(),n.Y8G("ngIf",t.showDeleteConfirm)}}let x=(()=>{class e{constructor(t,o,i){this.buildingService=t,this.route=o,this.router=i,this.loading=!1,this.error=null,this.showDeleteConfirm=!1,this.deleteError=null,this.destroy$=new g.B}ngOnInit(){this.route.params.pipe((0,l.Q)(this.destroy$)).subscribe(t=>{const o=+t.id;o&&this.loadBuilding(o)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadBuilding(t){this.loading=!0,this.buildingService.getBuildingById(t).pipe((0,l.Q)(this.destroy$)).subscribe({next:o=>{this.building=o,this.loading=!1},error:()=>{this.error="Building not found",this.loading=!1}})}editBuilding(){this.building&&this.router.navigate(["/buildings",this.building.id,"edit"])}confirmDelete(){this.showDeleteConfirm=!0,this.deleteError=null}cancelDelete(){this.showDeleteConfirm=!1,this.deleteError=null}deleteBuilding(){this.building&&(this.loading=!0,this.buildingService.deleteBuilding(this.building.id).pipe((0,l.Q)(this.destroy$)).subscribe({next:()=>{this.router.navigate(["/buildings"])},error:t=>{this.loading=!1,this.showDeleteConfirm=!1,this.deleteError=t.error?.unitCount?`Cannot delete building. It contains ${t.error.unitCount} housing unit(s).`:"Failed to delete building. Please try again."}}))}goBack(){this.router.navigate(["/buildings"])}formatDate(t){return t?new Date(t).toLocaleDateString():"N/A"}static{this.\u0275fac=function(o){return new(o||e)(n.rXU(P.Q),n.rXU(a.nX),n.rXU(a.Ix))}}static{this.\u0275cmp=n.VBU({type:e,selectors:[["app-building-details"]],standalone:!0,features:[n.aNF],decls:4,vars:3,consts:[[1,"building-details-container"],["class","loading",4,"ngIf"],["class","error-container",4,"ngIf"],["class","details-content",4,"ngIf"],[1,"loading"],[1,"error-container"],[1,"error"],[1,"btn","btn-primary",3,"click"],[1,"details-content"],[1,"header"],[1,"actions"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-danger",3,"click"],["class","alert alert-error",4,"ngIf"],[1,"info-card"],[1,"info-grid"],[1,"info-item"],[3,"ownerType","ownerId"],[3,"buildingId"],["class","modal-overlay",4,"ngIf"],[1,"alert","alert-error"],[1,"modal-overlay"],[1,"modal-content"],[1,"warning"],[1,"modal-actions"]],template:function(o,i){1&o&&(n.j41(0,"div",0),n.DNE(1,O,2,0,"div",1)(2,M,5,1,"div",2)(3,E,75,16,"div",3),n.k0s()),2&o&&(n.R7$(),n.Y8G("ngIf",i.loading),n.R7$(),n.Y8G("ngIf",i.error&&!i.loading),n.R7$(),n.Y8G("ngIf",i.building&&!i.loading))},dependencies:[d.MD,d.bT,v,m.q],styles:[".building-details-container[_ngcontent-%COMP%]{padding:2rem;max-width:1200px;margin:0 auto}.loading[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:#666;font-size:1.1rem}.error-container[_ngcontent-%COMP%]{text-align:center;padding:3rem}.error-container[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:#dc3545;font-size:1.1rem;margin-bottom:1.5rem}.details-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.details-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:2rem;color:#333}.details-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.alert[_ngcontent-%COMP%]{padding:1rem;border-radius:4px;margin-bottom:1.5rem}.alert.alert-error[_ngcontent-%COMP%]{background-color:#f8d7da;border:1px solid #f5c6cb;color:#721c24}.info-card[_ngcontent-%COMP%]{background:#fff;padding:2rem;border-radius:8px;box-shadow:0 2px 4px #0000001a;margin-bottom:1.5rem}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 1.5rem;font-size:1.5rem;color:#333;border-bottom:2px solid #007bff;padding-bottom:.5rem}.info-card[_ngcontent-%COMP%]   .empty-message[_ngcontent-%COMP%]{color:#6c757d;font-style:italic}.info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem}.info-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:600;color:#6c757d;font-size:.875rem;margin-bottom:.25rem;text-transform:uppercase;letter-spacing:.5px}.info-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#333;font-size:1rem}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:8px;max-width:500px;width:90%;box-shadow:0 4px 6px #0000001a}.modal-header[_ngcontent-%COMP%]{padding:1.5rem;border-bottom:1px solid #dee2e6}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;color:#333}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 1rem;color:#333}.modal-body[_ngcontent-%COMP%]   p.warning[_ngcontent-%COMP%]{color:#dc3545;font-weight:500;margin-top:1rem}.modal-body[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:600}.modal-actions[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-top:1px solid #dee2e6;display:flex;justify-content:flex-end;gap:.5rem}.btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:4px;font-size:1rem;cursor:pointer;transition:all .2s}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn.btn-primary[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.btn.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#0056b3}.btn.btn-secondary[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.btn.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#5a6268}.btn.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.btn.btn-danger[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#c82333}@media (max-width: 768px){.building-details-container[_ngcontent-%COMP%]{padding:1rem}.details-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;align-items:stretch}.details-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{justify-content:stretch}.details-content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{flex:1}.info-card[_ngcontent-%COMP%]{padding:1.5rem}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem}.info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}.modal-content[_ngcontent-%COMP%]{margin:1rem}.modal-actions[_ngcontent-%COMP%]{flex-direction:column-reverse}.modal-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}}"]})}}return e})()}}]);