"use strict";(self.webpackChunkimmocare_frontend=self.webpackChunkimmocare_frontend||[]).push([[131],{9131:(z,p,l)=>{l.r(p),l.d(p,{BuildingListComponent:()=>V});var b=l(177),a=l(4341),_=l(1413),M=l(8359);class v extends M.yU{constructor(e,n){super()}schedule(e,n=0){return this}}const h={setInterval(o,e,...n){const{delegate:i}=h;return i?.setInterval?i.setInterval(o,e,...n):setInterval(o,e,...n)},clearInterval(o){const{delegate:e}=h;return(e?.clearInterval||clearInterval)(o)},delegate:void 0};var y=l(7908);const C={now:()=>(C.delegate||Date).now(),delegate:void 0};class u{constructor(e,n=u.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,i){return new this.schedulerActionCtor(this,e).schedule(i,n)}}u.now=C.now;const x=new class k extends u{constructor(e,n=u.now){super(e,n),this.actions=[],this._active=!1}flush(e){const{actions:n}=this;if(this._active)return void n.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=n.shift());if(this._active=!1,i){for(;e=n.shift();)e.unsubscribe();throw i}}}(class F extends v{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var i;if(this.closed)return this;this.state=e;const s=this.id,r=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(r,s,n)),this.pending=!0,this.delay=n,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(r,this.id,n),this}requestAsyncId(e,n,i=0){return h.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,n,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return n;null!=n&&h.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,n);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let s,i=!1;try{this.work(e)}catch(r){i=!0,s=r||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:e,scheduler:n}=this,{actions:i}=n;this.work=this.state=this.scheduler=null,this.pending=!1,(0,y.o)(i,this),null!=e&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}});var m=l(9974),P=l(4360),j=l(3669);function E(o,e){return o===e}var f=l(6977),t=l(4438),w=l(7952),$=l(7282);function R(o,e){if(1&o&&(t.j41(0,"option",16),t.EFF(1),t.k0s()),2&o){const n=e.$implicit;t.Y8G("value",n),t.R7$(),t.SpI(" ",n," ")}}function T(o,e){1&o&&(t.j41(0,"div",17),t.EFF(1," Loading buildings... "),t.k0s())}function S(o,e){if(1&o&&(t.j41(0,"div",18),t.EFF(1),t.k0s()),2&o){const n=t.XpG();t.R7$(),t.SpI(" ",n.error," ")}}function L(o,e){1&o&&(t.j41(0,"div",19)(1,"p"),t.EFF(2,"No buildings yet"),t.k0s(),t.j41(3,"p",20),t.EFF(4,"Create your first building to get started"),t.k0s()())}function G(o,e){if(1&o&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&o){const n=t.XpG(2);t.R7$(),t.SpI(" ","asc"===n.sortDirection?"\u25b2":"\u25bc"," ")}}function N(o,e){if(1&o&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&o){const n=t.XpG(2);t.R7$(),t.SpI(" ","asc"===n.sortDirection?"\u25b2":"\u25bc"," ")}}function A(o,e){if(1&o){const n=t.RV6();t.j41(0,"tr",25),t.bIt("click",function(){const s=t.eBV(n).$implicit,r=t.XpG(2);return t.Njj(r.viewBuilding(s))}),t.j41(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td"),t.EFF(10),t.k0s(),t.j41(11,"td"),t.EFF(12),t.k0s(),t.j41(13,"td")(14,"button",26),t.bIt("click",function(s){const r=t.eBV(n).$implicit;return t.XpG(2).viewBuilding(r),t.Njj(s.stopPropagation())}),t.EFF(15," View "),t.k0s()()()}if(2&o){const n=e.$implicit;t.R7$(2),t.JRh(n.name),t.R7$(2),t.Lme("",n.streetAddress,", ",n.postalCode,""),t.R7$(2),t.JRh(n.city),t.R7$(2),t.JRh(n.country),t.R7$(2),t.JRh(n.ownerName||"Not specified"),t.R7$(2),t.SpI("",n.unitCount," units")}}function D(o,e){if(1&o){const n=t.RV6();t.j41(0,"div",21)(1,"table")(2,"thead")(3,"tr")(4,"th",22),t.bIt("click",function(){t.eBV(n);const s=t.XpG();return t.Njj(s.onSortChange("name"))}),t.EFF(5," Name "),t.DNE(6,G,2,1,"span",23),t.k0s(),t.j41(7,"th"),t.EFF(8,"Address"),t.k0s(),t.j41(9,"th",22),t.bIt("click",function(){t.eBV(n);const s=t.XpG();return t.Njj(s.onSortChange("city"))}),t.EFF(10," City "),t.DNE(11,N,2,1,"span",23),t.k0s(),t.j41(12,"th"),t.EFF(13,"Country"),t.k0s(),t.j41(14,"th"),t.EFF(15,"Owner"),t.k0s(),t.j41(16,"th"),t.EFF(17,"Units"),t.k0s(),t.j41(18,"th"),t.EFF(19,"Actions"),t.k0s()()(),t.j41(20,"tbody"),t.DNE(21,A,16,7,"tr",24),t.k0s()()()}if(2&o){const n=t.XpG();t.R7$(6),t.Y8G("ngIf","name"===n.sortField),t.R7$(5),t.Y8G("ngIf","city"===n.sortField),t.R7$(10),t.Y8G("ngForOf",n.buildings)}}function Y(o,e){if(1&o){const n=t.RV6();t.j41(0,"div",27)(1,"button",28),t.bIt("click",function(){t.eBV(n);const s=t.XpG();return t.Njj(s.previousPage())}),t.EFF(2," Previous "),t.k0s(),t.j41(3,"span",29),t.EFF(4),t.k0s(),t.j41(5,"button",28),t.bIt("click",function(){t.eBV(n);const s=t.XpG();return t.Njj(s.nextPage())}),t.EFF(6," Next "),t.k0s()()}if(2&o){const n=t.XpG();t.R7$(),t.Y8G("disabled",0===n.currentPage),t.R7$(3),t.E5c(" Page ",n.currentPage+1," of ",n.totalPages," (",n.totalElements," total) "),t.R7$(),t.Y8G("disabled",n.currentPage>=n.totalPages-1)}}let V=(()=>{class o{constructor(n,i){this.buildingService=n,this.router=i,this.buildings=[],this.cities=[],this.currentPage=0,this.pageSize=20,this.totalElements=0,this.totalPages=0,this.selectedCity="",this.searchTerm="",this.sortField="name",this.sortDirection="asc",this.searchSubject=new _.B,this.destroy$=new _.B,this.loading=!1,this.error=null}ngOnInit(){this.loadCities(),this.loadBuildings(),this.searchSubject.pipe(function B(o,e=x){return(0,m.N)((n,i)=>{let s=null,r=null,c=null;const g=()=>{if(s){s.unsubscribe(),s=null;const d=r;r=null,i.next(d)}};function X(){const d=c+o,O=e.now();if(O<d)return s=this.schedule(void 0,d-O),void i.add(s);g()}n.subscribe((0,P._)(i,d=>{r=d,c=e.now(),s||(s=e.schedule(X,o),i.add(s))},()=>{g(),i.complete()},void 0,()=>{r=s=null}))})}(300),function I(o,e=j.D){return o=o??E,(0,m.N)((n,i)=>{let s,r=!0;n.subscribe((0,P._)(i,c=>{const g=e(c);(r||!o(s,g))&&(r=!1,s=g,i.next(c))}))})}(),(0,f.Q)(this.destroy$)).subscribe(n=>{this.searchTerm=n,this.currentPage=0,this.loadBuildings()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadBuildings(){this.loading=!0,this.error=null,this.buildingService.getAllBuildings(this.currentPage,this.pageSize,`${this.sortField},${this.sortDirection}`,this.selectedCity||void 0,this.searchTerm||void 0).pipe((0,f.Q)(this.destroy$)).subscribe({next:i=>{this.buildings=i.content,this.totalElements=i.totalElements,this.totalPages=i.totalPages,this.currentPage=i.number,this.loading=!1},error:()=>{this.error="Failed to load buildings",this.loading=!1}})}loadCities(){this.buildingService.getAllCities().pipe((0,f.Q)(this.destroy$)).subscribe({next:n=>{this.cities=n}})}onSearchChange(n){this.searchSubject.next(n)}onCityFilterChange(n){this.selectedCity=n,this.currentPage=0,this.loadBuildings()}onSortChange(n){this.sortField===n?this.sortDirection="asc"===this.sortDirection?"desc":"asc":(this.sortField=n,this.sortDirection="asc"),this.loadBuildings()}previousPage(){this.currentPage>0&&(this.currentPage--,this.loadBuildings())}nextPage(){this.currentPage<this.totalPages-1&&(this.currentPage++,this.loadBuildings())}viewBuilding(n){this.router.navigate(["/buildings",n.id])}createBuilding(){this.router.navigate(["/buildings/new"])}clearFilters(){this.selectedCity="",this.searchTerm="",this.currentPage=0,this.loadBuildings()}static{this.\u0275fac=function(i){return new(i||o)(t.rXU(w.Q),t.rXU($.Ix))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-building-list"]],standalone:!0,features:[t.aNF],decls:21,vars:8,consts:[[1,"building-list-container"],[1,"header"],[1,"btn","btn-primary",3,"click"],[1,"filters"],[1,"search-box"],["type","text","placeholder","Search buildings...",3,"input","value"],[1,"city-filter"],[3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-secondary",3,"click"],["class","loading",4,"ngIf"],["class","error",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","buildings-table",4,"ngIf"],["class","pagination",4,"ngIf"],[3,"value"],[1,"loading"],[1,"error"],[1,"empty-state"],[1,"help-text"],[1,"buildings-table"],[1,"sortable",3,"click"],[4,"ngIf"],["class","clickable",3,"click",4,"ngFor","ngForOf"],[1,"clickable",3,"click"],[1,"btn","btn-sm","btn-link",3,"click"],[1,"pagination"],[1,"btn","btn-secondary",3,"click","disabled"],[1,"page-info"]],template:function(i,s){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"h1"),t.EFF(3,"Buildings"),t.k0s(),t.j41(4,"button",2),t.bIt("click",function(){return s.createBuilding()}),t.EFF(5," Create Building "),t.k0s()(),t.j41(6,"div",3)(7,"div",4)(8,"input",5),t.bIt("input",function(c){return s.onSearchChange(c.target.value)}),t.k0s()(),t.j41(9,"div",6)(10,"select",7),t.mxI("ngModelChange",function(c){return t.DH7(s.selectedCity,c)||(s.selectedCity=c),c}),t.bIt("change",function(){return s.onCityFilterChange(s.selectedCity)}),t.j41(11,"option",8),t.EFF(12,"All Cities"),t.k0s(),t.DNE(13,R,2,2,"option",9),t.k0s()(),t.j41(14,"button",10),t.bIt("click",function(){return s.clearFilters()}),t.EFF(15," Clear Filters "),t.k0s()(),t.DNE(16,T,2,0,"div",11)(17,S,2,1,"div",12)(18,L,5,0,"div",13)(19,D,22,3,"div",14)(20,Y,7,5,"div",15),t.k0s()),2&i&&(t.R7$(8),t.Y8G("value",s.searchTerm),t.R7$(2),t.R50("ngModel",s.selectedCity),t.R7$(3),t.Y8G("ngForOf",s.cities),t.R7$(3),t.Y8G("ngIf",s.loading),t.R7$(),t.Y8G("ngIf",s.error),t.R7$(),t.Y8G("ngIf",!s.loading&&!s.error&&0===s.buildings.length),t.R7$(),t.Y8G("ngIf",!s.loading&&!s.error&&s.buildings.length>0),t.R7$(),t.Y8G("ngIf",s.totalPages>1))},dependencies:[b.MD,b.Sq,b.bT,a.YN,a.xH,a.y7,a.wz,a.BC,a.vS],styles:[".building-list-container[_ngcontent-%COMP%]{padding:2rem;max-width:1400px;margin:0 auto}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:2rem;color:#333}.filters[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1.5rem;flex-wrap:wrap}.filters[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.5rem 1rem;border:1px solid #ddd;border-radius:4px;width:300px;font-size:1rem}.filters[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff}.filters[_ngcontent-%COMP%]   .city-filter[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.5rem 1rem;border:1px solid #ddd;border-radius:4px;font-size:1rem;cursor:pointer}.filters[_ngcontent-%COMP%]   .city-filter[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff}.loading[_ngcontent-%COMP%], .error[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:#666;font-size:1.1rem}.error[_ngcontent-%COMP%]{color:#dc3545}.empty-state[_ngcontent-%COMP%]   .help-text[_ngcontent-%COMP%]{color:#999;font-size:.9rem;margin-top:.5rem}.buildings-table[_ngcontent-%COMP%]{overflow-x:auto;background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}.buildings-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.buildings-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:2px solid #dee2e6}.buildings-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:1rem;text-align:left;font-weight:600;color:#495057}.buildings-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none}.buildings-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]:hover{background-color:#e9ecef}.buildings-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th.sortable[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:.5rem;color:#007bff}.buildings-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;transition:background-color .2s}.buildings-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.clickable[_ngcontent-%COMP%]{cursor:pointer}.buildings-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.clickable[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}.buildings-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;color:#212529}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:1rem;margin-top:2rem}.pagination[_ngcontent-%COMP%]   .page-info[_ngcontent-%COMP%]{color:#666;font-size:.9rem}.btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:4px;font-size:1rem;cursor:pointer;transition:all .2s}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn.btn-primary[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.btn.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#0056b3}.btn.btn-secondary[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.btn.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#5a6268}.btn.btn-link[_ngcontent-%COMP%]{background:none;color:#007bff;text-decoration:none}.btn.btn-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.btn.btn-sm[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.875rem}@media (max-width: 768px){.building-list-container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;align-items:stretch}.filters[_ngcontent-%COMP%]{flex-direction:column}.filters[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}.buildings-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{font-size:.9rem}.buildings-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .buildings-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem}}"]})}}return o})()}}]);