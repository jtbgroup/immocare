"use strict";(self.webpackChunkimmocare_frontend=self.webpackChunkimmocare_frontend||[]).push([[344],{2304:(h,c,i)=>{i.d(c,{J:()=>g});var l=i(5312),o=i(4438),f=i(1626);let g=(()=>{class d{constructor(s){this.http=s,this.baseUrl=`${l.c.apiUrl}`}getUnitsByBuilding(s){return this.http.get(`${this.baseUrl}/buildings/${s}/units`)}getUnitById(s){return this.http.get(`${this.baseUrl}/units/${s}`)}create(s){return this.http.post(`${this.baseUrl}/units`,s)}update(s,m){return this.http.put(`${this.baseUrl}/units/${s}`,m)}delete(s){return this.http.delete(`${this.baseUrl}/units/${s}`)}static{this.\u0275fac=function(m){return new(m||d)(o.KVO(f.Qq))}}static{this.\u0275prov=o.jDH({token:d,factory:d.\u0275fac,providedIn:"root"})}}return d})()},9344:(h,c,i)=>{i.r(c),i.d(c,{HousingUnitFormComponent:()=>U});var l=i(177),o=i(4341),f=i(1413),g=i(6977);const d=["N","S","E","W","NE","NW","SE","SW"];var n=i(4438),s=i(2304),m=i(7282);function b(e,u){if(1&e&&(n.j41(0,"div",18),n.EFF(1),n.k0s()),2&e){const t=n.XpG();n.R7$(),n.JRh(t.errorMessage)}}function v(e,u){1&e&&(n.j41(0,"div",19),n.EFF(1,"Unit number is required."),n.k0s())}function F(e,u){1&e&&(n.j41(0,"div",19),n.EFF(1,"Floor is required (\u221210 to 100)."),n.k0s())}function C(e,u){1&e&&(n.j41(0,"div",19),n.EFF(1,"Terrace surface must be greater than 0."),n.k0s())}function _(e,u){if(1&e&&(n.j41(0,"option",25),n.EFF(1),n.k0s()),2&e){const t=u.$implicit;n.Y8G("value",t),n.R7$(),n.JRh(t)}}function E(e,u){if(1&e&&(n.j41(0,"div",20)(1,"div",3)(2,"label"),n.EFF(3,"Terrace Surface (m\xb2)"),n.k0s(),n.nrm(4,"input",21),n.DNE(5,C,2,0,"div",6),n.k0s(),n.j41(6,"div",3)(7,"label"),n.EFF(8,"Terrace Orientation"),n.k0s(),n.j41(9,"select",22)(10,"option",23),n.EFF(11,"\u2014 Select \u2014"),n.k0s(),n.DNE(12,_,2,2,"option",24),n.k0s()()()),2&e){const t=n.XpG();n.R7$(5),n.Y8G("ngIf",t.isInvalid("terraceSurface")),n.R7$(7),n.Y8G("ngForOf",t.orientations)}}function O(e,u){1&e&&(n.j41(0,"div",19),n.EFF(1,"Garden surface must be greater than 0."),n.k0s())}function M(e,u){if(1&e&&(n.j41(0,"option",25),n.EFF(1),n.k0s()),2&e){const t=u.$implicit;n.Y8G("value",t),n.R7$(),n.JRh(t)}}function k(e,u){if(1&e&&(n.j41(0,"div",20)(1,"div",3)(2,"label"),n.EFF(3,"Garden Surface (m\xb2)"),n.k0s(),n.nrm(4,"input",26),n.DNE(5,O,2,0,"div",6),n.k0s(),n.j41(6,"div",3)(7,"label"),n.EFF(8,"Garden Orientation"),n.k0s(),n.j41(9,"select",27)(10,"option",23),n.EFF(11,"\u2014 Select \u2014"),n.k0s(),n.DNE(12,M,2,2,"option",24),n.k0s()()()),2&e){const t=n.XpG();n.R7$(5),n.Y8G("ngIf",t.isInvalid("gardenSurface")),n.R7$(7),n.Y8G("ngForOf",t.orientations)}}let U=(()=>{class e{constructor(t,a,r,p){this.fb=t,this.housingUnitService=a,this.route=r,this.router=p,this.isEditMode=!1,this.saving=!1,this.errorMessage="",this.orientations=d,this.destroy$=new f.B}ngOnInit(){this.buildingId=this.route.snapshot.queryParams.buildingId?+this.route.snapshot.queryParams.buildingId:void 0;const t=this.route.snapshot.paramMap.get("id");this.isEditMode=!!t,this.buildForm(),this.isEditMode&&t&&(this.unitId=+t,this.loadUnit(this.unitId))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}buildForm(){this.form=this.fb.group({unitNumber:["",o.k0.required],floor:[0,[o.k0.required,o.k0.min(-10),o.k0.max(100)]],landingNumber:[""],totalSurface:[null],ownerName:[""],hasTerrace:[!1],terraceSurface:[null],terraceOrientation:[""],hasGarden:[!1],gardenSurface:[null],gardenOrientation:[""]})}loadUnit(t){this.housingUnitService.getUnitById(t).pipe((0,g.Q)(this.destroy$)).subscribe({next:a=>{this.form.patchValue(a),this.buildingId=a.buildingId},error:()=>{this.errorMessage="Failed to load unit."}})}isInvalid(t){const a=this.form.get(t);return!!(a&&a.invalid&&a.touched)}onSubmit(){if(this.form.invalid)return void this.form.markAllAsTouched();this.saving=!0;const t={...this.form.value,buildingId:this.buildingId};(this.isEditMode&&this.unitId?this.housingUnitService.update(this.unitId,t):this.housingUnitService.create(t)).pipe((0,g.Q)(this.destroy$)).subscribe({next:r=>{this.router.navigate(["/units",r.id])},error:r=>{this.saving=!1,this.errorMessage=r.error?.message??"Failed to save unit."}})}onCancel(){this.router.navigate(this.buildingId?["/buildings",this.buildingId]:["/buildings"])}static{this.\u0275fac=function(a){return new(a||e)(n.rXU(o.ok),n.rXU(s.J),n.rXU(m.nX),n.rXU(m.Ix))}}static{this.\u0275cmp=n.VBU({type:e,selectors:[["app-housing-unit-form"]],standalone:!0,features:[n.aNF],decls:46,vars:9,consts:[[1,"form-container"],["class","error-banner",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"form-group"],[1,"required"],["formControlName","unitNumber","placeholder","e.g. A101"],["class","error",4,"ngIf"],["type","number","formControlName","floor"],["formControlName","landingNumber","placeholder","Optional"],["type","number","step","0.01","formControlName","totalSurface"],["formControlName","ownerName","placeholder","Leave empty to inherit from building"],[1,"section-toggle"],["type","checkbox","formControlName","hasTerrace"],["class","sub-section",4,"ngIf"],["type","checkbox","formControlName","hasGarden"],[1,"form-actions"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"error-banner"],[1,"error"],[1,"sub-section"],["type","number","step","0.01","formControlName","terraceSurface"],["formControlName","terraceOrientation"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["type","number","step","0.01","formControlName","gardenSurface"],["formControlName","gardenOrientation"]],template:function(a,r){1&a&&(n.j41(0,"div",0)(1,"h2"),n.EFF(2),n.k0s(),n.DNE(3,b,2,1,"div",1),n.j41(4,"form",2),n.bIt("ngSubmit",function(){return r.onSubmit()}),n.j41(5,"div",3)(6,"label"),n.EFF(7,"Unit Number "),n.j41(8,"span",4),n.EFF(9,"*"),n.k0s()(),n.nrm(10,"input",5),n.DNE(11,v,2,0,"div",6),n.k0s(),n.j41(12,"div",3)(13,"label"),n.EFF(14,"Floor "),n.j41(15,"span",4),n.EFF(16,"*"),n.k0s()(),n.nrm(17,"input",7),n.DNE(18,F,2,0,"div",6),n.k0s(),n.j41(19,"div",3)(20,"label"),n.EFF(21,"Landing / Staircase"),n.k0s(),n.nrm(22,"input",8),n.k0s(),n.j41(23,"div",3)(24,"label"),n.EFF(25,"Total Surface (m\xb2)"),n.k0s(),n.nrm(26,"input",9),n.k0s(),n.j41(27,"div",3)(28,"label"),n.EFF(29,"Owner Name"),n.k0s(),n.nrm(30,"input",10),n.k0s(),n.j41(31,"div",11)(32,"label"),n.nrm(33,"input",12),n.EFF(34," Has Terrace "),n.k0s()(),n.DNE(35,E,13,2,"div",13),n.j41(36,"div",11)(37,"label"),n.nrm(38,"input",14),n.EFF(39," Has Garden "),n.k0s()(),n.DNE(40,k,13,2,"div",13),n.j41(41,"div",15)(42,"button",16),n.EFF(43),n.k0s(),n.j41(44,"button",17),n.bIt("click",function(){return r.onCancel()}),n.EFF(45,"Cancel"),n.k0s()()()()),2&a&&(n.R7$(2),n.JRh(r.isEditMode?"Edit Housing Unit":"New Housing Unit"),n.R7$(),n.Y8G("ngIf",r.errorMessage),n.R7$(),n.Y8G("formGroup",r.form),n.R7$(7),n.Y8G("ngIf",r.isInvalid("unitNumber")),n.R7$(7),n.Y8G("ngIf",r.isInvalid("floor")),n.R7$(17),n.Y8G("ngIf",r.form.value.hasTerrace),n.R7$(5),n.Y8G("ngIf",r.form.value.hasGarden),n.R7$(2),n.Y8G("disabled",r.saving),n.R7$(),n.SpI(" ",r.saving?"Saving\u2026":"Save"," "))},dependencies:[l.MD,l.Sq,l.bT,o.X1,o.qT,o.xH,o.y7,o.me,o.Q0,o.Zm,o.wz,o.BC,o.cb,o.j4,o.JD],styles:[".form-container[_ngcontent-%COMP%]{max-width:600px;margin:2rem auto;padding:0 1rem}.form-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 1.5rem;font-size:1.5rem;color:#333}.error-banner[_ngcontent-%COMP%]{background:#f8d7da;border:1px solid #f5c6cb;color:#721c24;padding:.75rem 1rem;border-radius:4px;margin-bottom:1.25rem;font-size:.9rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1.25rem;display:flex;flex-direction:column}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;margin-bottom:.4rem;color:#333}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.6rem .75rem;border:1px solid #ccc;border-radius:4px;font-size:1rem;transition:border-color .2s}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#4a6fa5}.required[_ngcontent-%COMP%]{color:#dc3545}.error[_ngcontent-%COMP%]{font-size:.8rem;color:#dc3545;margin-top:.25rem}.section-toggle[_ngcontent-%COMP%]{margin-bottom:.75rem}.section-toggle[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-weight:500;cursor:pointer}.section-toggle[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:1rem;height:1rem;cursor:pointer}.sub-section[_ngcontent-%COMP%]{background:#f8f9fa;border-left:3px solid #4a6fa5;padding:1rem;margin-bottom:1.25rem;border-radius:0 4px 4px 0}.form-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;margin-top:1.5rem}.btn[_ngcontent-%COMP%]{padding:.6rem 1.25rem;border:none;border-radius:4px;font-size:1rem;font-weight:500;cursor:pointer;transition:background .2s}.btn[_ngcontent-%COMP%]:disabled{opacity:.65;cursor:not-allowed}.btn.btn-primary[_ngcontent-%COMP%]{background:#4a6fa5;color:#fff}.btn.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#3a5f95}.btn.btn-secondary[_ngcontent-%COMP%]{background:#6c757d;color:#fff}.btn.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#5a6268}"]})}}return e})()}}]);